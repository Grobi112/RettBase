// Firebase Storage Security Rules
// Authentifizierte Benutzer dürfen auf kunden-spezifische Pfade zugreifen.

rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    match /kunden/{companyId}/profile-images/{fileName} {
      allow read, write: if request.auth != null;
    }

    match /kunden/{companyId}/email-attachments/{emailId}/{fileName} {
      allow read, write: if request.auth != null;
    }

    match /kunden/{companyId}/chat-attachments/{allPaths=**} {
      allow read, write: if request.auth != null;
    }

    match /kunden/{companyId}/maengel-attachments/{allPaths=**} {
      allow read, write: if request.auth != null;
    }

    match /kunden/{companyId}/unfallbericht-attachments/{allPaths=**} {
      allow read, write: if request.auth != null;
    }

    // Einsatzprotokoll Schulsanitätsdienst: Körper-Skizze, Unterschriften
    match /kunden/{companyId}/einsatzprotokoll-ssd/{docId}/{fileName} {
      allow read, write: if request.auth != null;
    }

    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
